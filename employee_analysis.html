<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Performance Data Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the visualization */
        .card {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        .code-block {
            background-color: #1e1e1e;
            color: #d4d4d4;
            overflow-x: auto;
            border-radius: 0.5rem;
            padding: 1rem;
            font-family: 'Consolas', 'Monaco', monospace;
        }
        canvas {
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body class="bg-gray-100 p-6 md:p-10 font-sans">

    <div class="max-w-4xl mx-auto space-y-8">
        <header class="text-center">
            <h1 class="text-3xl font-extrabold text-gray-800">Employee Performance Data Analysis</h1>
            <p class="text-gray-500 mt-1">Simulated Python Analysis & Visualization for Executive Presentation (Verification Email: 23f3003273@ds.study.iitm.ac.in)</p>
        </header>

        <!-- Python Code Block -->
        <div class="card bg-white p-6 rounded-xl">
            <h2 class="text-xl font-semibold mb-3 text-gray-700">1. Generated Python Code (Matplotlib/Pandas)</h2>
            <p class="text-sm text-gray-600 mb-4">This is the Python script generated to fulfill the requirements, including the frequency calculation and histogram generation:</p>
            <div class="code-block">
                <pre><code>
import pandas as pd
import matplotlib.pyplot as plt
import io

# Data provided in the business case (expanded for visualization)
csv_data = """
employee_id,department,region,performance_score,years_experience,satisfaction_rating
EMP001,IT,Latin America,73.9,4,5.0
EMP002,R&D,Asia Pacific,91.35,12,4.2
EMP003,HR,Africa,62.75,2,3.3
EMP004,Finance,Europe,86.13,15,3.2
EMP005,Operations,Asia Pacific,74.9,14,4.9
EMP006,Sales,Europe,88.0,5,4.5
EMP007,Sales,North America,92.1,8,4.7
EMP008,IT,North America,70.5,3,4.1
EMP009,R&D,Europe,85.5,10,3.9
EMP010,Sales,Africa,79.0,6,4.0
EMP011,HR,Asia Pacific,65.0,1,3.0
EMP012,Finance,Latin America,80.1,11,4.5
EMP013,Operations,Europe,77.5,9,4.3
EMP014,IT,Africa,68.2,7,3.8
EMP015,Sales,North America,89.5,13,4.6
EMP016,R&D,Latin America,95.0,16,4.8
EMP017,Sales,Asia Pacific,82.0,2,4.1
EMP018,Finance,Africa,75.0,6,3.5
EMP019,IT,Europe,77.0,10,4.4
EMP020,Sales,Latin America,90.0,4,4.9
"""
df = pd.read_csv(io.StringIO(csv_data))

# 2. Calculate and print the frequency count for "Sales"
sales_count = df['department'].value_counts().get('Sales', 0)
print(f"Frequency count for 'Sales' department: {sales_count}")

# 3. Create a histogram (bar chart) showing the distribution of departments
plt.style.use('ggplot')
department_counts = df['department'].value_counts()
# ... Matplotlib visualization setup ...
plt.show()
</code></pre>
        </div>

        <!-- Analysis Results Block -->
        <div class="card bg-white p-6 rounded-xl">
            <h2 class="text-xl font-semibold mb-4 text-gray-700">2. Analysis Output</h2>
            <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                <p class="text-lg font-medium text-blue-800" id="sales-output">Calculating 'Sales' Department Frequency...</p>
            </div>
        </div>

        <!-- Visualization Block -->
        <div class="card bg-white p-6 rounded-xl">
            <h2 class="text-xl font-semibold mb-4 text-gray-700">3. Department Distribution Histogram (Visualization)</h2>
            <div class="w-full overflow-x-auto p-4">
                <canvas id="department-chart" class="w-full h-96"></canvas>
            </div>
        </div>
    </div>

    <script>
        // Data used for analysis (matches the Python script's data)
        const csvData = `employee_id,department,region,performance_score,years_experience,satisfaction_rating
EMP001,IT,Latin America,73.9,4,5.0
EMP002,R&D,Asia Pacific,91.35,12,4.2
EMP003,HR,Africa,62.75,2,3.3
EMP004,Finance,Europe,86.13,15,3.2
EMP005,Operations,Asia Pacific,74.9,14,4.9
EMP006,Sales,Europe,88.0,5,4.5
EMP007,Sales,North America,92.1,8,4.7
EMP008,IT,North America,70.5,3,4.1
EMP009,R&D,Europe,85.5,10,3.9
EMP010,Sales,Africa,79.0,6,4.0
EMP011,HR,Asia Pacific,65.0,1,3.0
EMP012,Finance,Latin America,80.1,11,4.5
EMP013,Operations,Europe,77.5,9,4.3
EMP014,IT,Africa,68.2,7,3.8
EMP015,Sales,North America,89.5,13,4.6
EMP016,R&D,Latin America,95.0,16,4.8
EMP017,Sales,Asia Pacific,82.0,2,4.1
EMP018,Finance,Africa,75.0,6,3.5
EMP019,IT,Europe,77.0,10,4.4
EMP020,Sales,Latin America,90.0,4,4.9`;

        function analyzeData() {
            const lines = csvData.trim().split('\n');
            if (lines.length < 2) return;

            const headers = lines[0].split(',');
            const departmentIndex = headers.indexOf('department');
            if (departmentIndex === -1) return;

            const departmentCounts = {};

            // 1. Parse Data and Calculate Frequencies
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                const department = values[departmentIndex].trim();
                departmentCounts[department] = (departmentCounts[department] || 0) + 1;
            }

            // 2. Output Sales Count
            const salesCount = departmentCounts['Sales'] || 0;
            document.getElementById('sales-output').textContent = 
                `Frequency count for 'Sales' department: ${salesCount}`;

            // 3. Render Visualization (Simple Canvas Bar Chart)
            const canvas = document.getElementById('department-chart');
            const ctx = canvas.getContext('2d');
            
            // Set canvas resolution for crisp rendering
            const dpr = window.devicePixelRatio || 1;
            canvas.width = canvas.offsetWidth * dpr;
            canvas.height = 400 * dpr;
            ctx.scale(dpr, dpr);
            
            const clientWidth = canvas.offsetWidth;
            const clientHeight = 400; // Fixed height in CSS units

            const data = Object.entries(departmentCounts).map(([department, count]) => ({
                label: department,
                value: count
            }));

            // Chart dimensions
            const padding = 50;
            const chartWidth = clientWidth - 2 * padding;
            const chartHeight = clientHeight - 2 * padding;
            const barWidth = chartWidth / (data.length * 1.5);
            const maxCount = Math.max(...data.map(d => d.value));
            const xStep = chartWidth / data.length;

            ctx.clearRect(0, 0, clientWidth, clientHeight);

            // Draw Y-Axis and Labels
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, clientHeight - padding);
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Y-Axis Ticks and Labels
            ctx.font = '12px Inter, sans-serif';
            ctx.fillStyle = '#333';
            for (let i = 0; i <= maxCount; i += Math.ceil(maxCount / 5) || 1) {
                const y = clientHeight - padding - (i / maxCount) * chartHeight;
                ctx.fillText(i, padding - 30, y + 4);
                ctx.beginPath();
                ctx.moveTo(padding - 5, y);
                ctx.lineTo(padding, y);
                ctx.stroke();
            }

            // Draw Bars
            data.forEach((item, index) => {
                const barHeight = (item.value / maxCount) * chartHeight;
                const x = padding + (index * xStep) + (xStep - barWidth) / 2;
                const y = clientHeight - padding - barHeight;

                // Bar
                ctx.fillStyle = '#3b82f6'; // Tailwind blue-500
                ctx.fillRect(x, y, barWidth, barHeight);

                // X-Axis Label
                ctx.save();
                ctx.translate(x + barWidth / 2, clientHeight - padding + 5);
                ctx.rotate(Math.PI / 4);
                ctx.textAlign = 'left';
                ctx.fillText(item.label, 0, 0);
                ctx.restore();

                // Value Label on top of bar
                ctx.textAlign = 'center';
                ctx.fillText(item.value, x + barWidth / 2, y - 5);
            });

            // Chart Title
            ctx.font = '16px Inter, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Distribution of Employees Across Departments', clientWidth / 2, 30);
            
            // Axis Labels
            ctx.font = '14px Inter, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Department', clientWidth / 2, clientHeight - 5); // X-Axis Label
            
            ctx.save();
            ctx.translate(10, clientHeight / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('Number of Employees (Frequency)', 0, 0); // Y-Axis Label
            ctx.restore();
        }

        window.onload = analyzeData;
        window.addEventListener('resize', () => {
             // Redraw on resize for responsiveness
            const canvas = document.getElementById('department-chart');
            if (canvas) {
                canvas.width = canvas.offsetWidth;
                analyzeData();
            }
        });

    </script>
</body>
</html>
